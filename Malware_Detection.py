import hashlib
import requests
import time
import json

class File_Detection():

    def sha256_hash(self,filename):
        with open(filename, "rb") as f:
            bytes = f.read()
            sha256hash = hashlib.sha256(bytes).hexdigest()
            f.close()
        return sha256hash;  

    def malware_checker(self, pathOfFile): # VirusTotal API

        Hash_Of_File = self.sha256_hash(pathOfFile) 

        api_key = "*************************" # <<<<<<<====== Put Your Own Key
        url = "https://www.virustotal.com/vtapi/v2/file/report"
        response_json = None
        try:
            params = {"apikey": api_key, "resource": Hash_Of_File}
            response = requests.get(url, params=params)
            response_json = json.loads(response.content)
            #print(response_json)
        except json.decoder.JSONDecodeError as e:
                print("Error decoding JSON:", e)
        try:
            if response_json['positives'] > 0:
                return  True  #("Malicious")
            else:
                return False #"Not Malicious"
        except KeyError: #<<<<<<<<<<<<<<<<<<< *****
            return False
